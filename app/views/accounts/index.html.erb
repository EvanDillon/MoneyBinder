<%= render partial: "shared/navigation_bar"%>
<%= render 'flash_messages' %>
<br>
<div class="container">
  <h1 class="text-center">Chart of Accounts</h1>

  <table class="table" id="table-layout">
    <thead>
    <tr>
        <th scope="col">Account #</th>
        <th scope="col">Name</th>
        <th scope="col">Type</th>
        <th scope="col">Sub-Type</th>
        <th scope="col">Balance</th>
        <th scope="col">Active</th>
        <th scope="col">Created By</th>
        <% if current_user.userType == 1 %>
          <th scope="col">Edit</th> 
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% @accounts.each do |account| %>
        <tr>
          <th scope="row"><%= link_to account.account_number, "/ledger/#{account.account_number}"%></th>
          <td><%= account.name %></td>
          <td><%= account.category %></td>
          <td><%= account.subcategory %></td>
          <td>$ <%= number_with_precision(account.balance, precision: 2, delimiter: ',')%></td>
          <td><%= account.active %></td>
          <td><%= User.find(account.user_id).username %></td>
          
          <% if current_user.userType == 1 %>
            <td><%= button_to "Edit", edit_account_path(account), method: :get, class: "btn btn-primary btn-sm"%></td>
          <% end %>
        </tr>
      <%end%>
    </tbody>
  </table>

  <div class = 'row'>
    <div class="col py-3 px-lg-2">
      <% if current_user.userType == 1 %>
        <%= button_to "Create New Account", new_account_path, method: :get, class: "btn btn-primary"%>
      <% end %>
    </div>
  </div>

</div>

<script>
  $(document).ready(function() {
    $('#table-layout').dataTable();
  });
</script>